# 食物热量分析 App 测试方案

## 1. 测试目标

验证食物热量分析 App 的功能完整性、性能指标和用户体验，确保产品达到 PRD 要求。

## 2. 测试范围

### 2.1 功能测试
- 拍照识别功能
- 食物记录管理
- 热量趋势统计
- 数据存储与读取

### 2.2 性能测试
- AI 识别响应时间
- 列表滚动流畅度
- 大量数据处理能力

### 2.3 兼容性测试
- macOS 平台兼容性
- 不同分辨率图片处理

### 2.4 用户体验测试
- UI 交互流程
- 错误处理友好性

## 3. 测试策略

### 3.1 手动测试
- 核心功能流程测试
- UI/UX 测试
- 边界条件测试

### 3.2 自动化测试
- 单元测试（数据模型、工具类）
- Widget 测试（UI 组件）
- 集成测试（完整流程）

## 4. 测试用例

### 4.1 拍照识别功能

#### TC001: 正常拍照识别流程
- **前置条件**: 应用已启动
- **测试步骤**:
  1. 点击首页相机按钮
  2. 选择/拍摄食物照片
  3. 等待 AI 识别完成
- **预期结果**: 
  - 识别在 60 秒内完成
  - 显示食物名称、成分、热量信息
  - 置信度 > 0.5

#### TC002: 从相册选择照片识别
- **前置条件**: 相册中有食物照片
- **测试步骤**:
  1. 点击"从相册选择"
  2. 选择一张食物照片
  3. 等待识别完成
- **预期结果**: 正常识别并显示结果

#### TC003: 识别超时处理
- **前置条件**: 网络条件较差
- **测试步骤**:
  1. 断网后选择照片
  2. 等待识别
- **预期结果**: 
  - 70秒后显示超时提示
  - 提示用户检查网络

#### TC004: 识别失败处理
- **前置条件**: 应用已启动
- **测试步骤**:
  1. 选择非食物照片（如风景照）
  2. 等待识别
- **预期结果**: 
  - 显示识别结果或提示无法识别
  - 不应崩溃

### 4.2 数据存储功能

#### TC005: 保存食物记录
- **前置条件**: 已完成食物识别
- **测试步骤**:
  1. 在结果页点击"保存"按钮
  2. 跳转到热量分析页
- **预期结果**: 
  - 记录成功保存
  - 在列表中显示新记录
  - 统计数据更新

#### TC006: 删除食物记录
- **前置条件**: 已有至少一条记录
- **测试步骤**:
  1. 在记录列表找到一条记录
  2. 点击删除按钮
  3. 确认删除
- **预期结果**: 
  - 记录从列表中移除
  - 统计数据更新

### 4.3 热量趋势统计

#### TC007: 周趋势显示
- **前置条件**: 有跨越多周的记录数据
- **测试步骤**:
  1. 切换到"周趋势" tab
  2. 查看图表
- **预期结果**: 
  - 显示最近12周的汇总数据
  - 每个数据点代表一周的总热量
  - 统计信息准确（平均、最高、最低）

#### TC008: 月趋势显示
- **前置条件**: 有跨越多月的记录数据
- **测试步骤**:
  1. 切换到"月趋势" tab
  2. 查看图表
- **预期结果**: 
  - 显示最近12个月的汇总数据
  - 每个数据点代表一月的总热量
  - 统计信息准确

#### TC009: 数据筛选
- **前置条件**: 有多条不同日期和餐次的记录
- **测试步骤**:
  1. 点击筛选按钮
  2. 选择日期范围
  3. 选择餐次类型（早/午/晚餐）
  4. 确认筛选
- **预期结果**: 
  - 列表只显示符合条件的记录
  - 统计数据基于筛选结果计算

### 4.4 UI/UX 测试

#### TC010: 食物卡片显示照片缩略图
- **前置条件**: 有食物记录
- **测试步骤**:
  1. 查看记录列表
- **预期结果**: 
  - 每条记录显示真实照片缩略图
  - 照片加载失败时显示默认图标

#### TC011: 统计数据显示真实值
- **前置条件**: 有食物记录
- **测试步骤**:
  1. 查看统计卡片
  2. 查看趋势统计
- **预期结果**: 
  - 所有数值基于真实数据计算
  - 无硬编码的模拟数据

## 5. 性能测试

### PT001: AI 识别响应时间
- **测试方法**: 记录10次识别的平均时间
- **通过标准**: 平均时间 < 60秒

### PT002: 列表滚动性能
- **测试方法**: 添加100条记录，测试滚动流畅度
- **通过标准**: 60fps，无明显卡顿

### PT003: 图表渲染性能
- **测试方法**: 加载包含30天数据的图表
- **通过标准**: 渲染时间 < 1秒

## 6. 测试环境

- **操作系统**: macOS 14.0+
- **Flutter版本**: 3.10.0+
- **测试设备**: MacBook Pro (M1/M2)

## 7. 测试数据

参见 `测试数据集.md`

## 8. 缺陷管理

### 8.1 优先级定义
- **P0**: 阻塞性问题，核心功能无法使用
- **P1**: 严重问题，重要功能受影响
- **P2**: 一般问题，次要功能受影响
- **P3**: 轻微问题，体验优化

### 8.2 缺陷报告格式
- 标题
- 复现步骤
- 实际结果
- 预期结果
- 优先级
- 截图/日志

## 9. 测试计划

### 第一轮（功能验证）
- 执行所有功能测试用例
- 验证核心流程正常运行

### 第二轮（性能&边界）
- 执行性能测试
- 测试边界条件和异常情况

### 第三轮（回归测试）
- 修复缺陷后重新测试
- 确保无新引入问题

## 10. 通过标准

- 所有 P0/P1 缺陷已修复
- P2 缺陷修复率 > 80%
- 核心功能测试通过率 100%
- 性能指标达标
